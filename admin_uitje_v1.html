<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Uitje â€“ Admin + Detail</title>
<style>
  body { font-family: Arial, sans-serif; margin: 0; background: #ececec; }
  h1 { margin: 0 0 16px 0; }
  .section { background: #fff; padding: 20px; margin-bottom: 20px; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
  #adminPage { background: #f4f8fb; padding: 30px; }
  #detailPage { background: #fff; padding: 30px; }
  hr.page-sep { margin: 0; border: 0; border-top: 8px solid #ccc; }
  .overview { border: 1px solid #e5e5e5; border-radius: 6px; overflow: hidden; }
  .overview-item { padding: 10px 12px; border-bottom: 1px solid #eee; background: #fff; display:flex; justify-content:space-between; align-items:center; }
  .overview-item:last-child { border-bottom: none; }
  .clickable { cursor: pointer; }
  .nav-bar { background: #333; padding: 10px; text-align: center; position: sticky; top: 0; z-index: 10; }
  .nav-bar button { background: #0078d4; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 14px; margin: 0 5px; }
  .nav-bar button:hover { background: #005a9e; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
  th { background: #f0f0f0; }
  td.welmee { background-color: #d4edda; }
  td.nietmee { background-color: #fff; }
  td.geannuleerd { background-color: #f8d7da; }
  .status-stempel { font-size: 1.5em; font-weight: bold; padding: 10px; border: 3px solid; display: inline-block; margin-top: 10px; }
  .status-groen { color: green; border-color: green; }
  .status-rood { color: red; border-color: red; }
</style>
</head>
<body>

<div class="nav-bar">
  <button id="showAdmin">Beheerpagina</button>
  <button id="showDetail">Detailpagina</button>
  <button id="showBoth">Toon beide</button>
</div>

<!-- ADMIN -->
<div id="adminPage">
  <h1>Admin â€“ Uitje Aanmaken <label><input type="checkbox" checked> Actief</label></h1>

  <!-- Algemeen -->
  <div class="section">
    <h2>Algemeen</h2>
    <label>Titel uitje <input type="text" id="admTitel" value="Dagje Rotterdam"></label>
    <label>Datum uitje <input type="date" id="admDatum" value="2025-09-20"></label>
    <label>Inschrijven tot <input type="date" id="admInschrijvenTot" value="2025-09-10"></label>
    <label>Annuleren tot <input type="date" id="admAnnulerenTot" value="2025-09-15"></label>
    <label>Google Maps link verzamelpunt <input type="url" id="admMapsLink"></label>
    <label>Algemene notitie <textarea id="admNotitie">Let op: Eten en extra's zoals drank, parkeren, souvenirs worden achteraf berekend tenzij de prijs vooraf bekend is.</textarea></label>
    <button>Opslaan</button>
  </div>

  <!-- Verzamelpunt -->
  <div class="section">
    <h2>Verzamelpunt</h2>
    <label>Verzamelplaats <input type="text" id="admVerzamelLocatie" value="Centraal Station Rotterdam"></label>
    <label>Verzameltijd <input type="time" id="admVerzamelTijd" value="09:30"></label>
    <label>Straat / Huisnummer <input type="text"></label>
    <label>Postcode <input type="text"></label>
    <label>Woonplaats <input type="text"></label>
    <label>Telefoon <input type="tel"></label>
    <button>Opslaan</button>
  </div>

  <!-- Activiteit -->
  <div class="section">
    <h2>Activiteit aanmaken / bewerken</h2>
    <input type="text" id="evtNaam" placeholder="Naam activiteit">
    <input type="time" id="evtStart">
    <input type="time" id="evtEind">
    <input type="number" id="evtPrijs" placeholder="Prijs p.p.">
    <input type="url" id="evtUrl" placeholder="https://...">
    <textarea id="evtNotitie" placeholder="Notitie (optioneel)"></textarea>
    <button onclick="addEvent()">Opslaan</button>
  </div>
  <div class="section">
    <h2>Overzicht activiteiten</h2>
    <div id="adminActiviteiten" class="overview"></div>
  </div>

  <!-- Reis -->
  <div class="section">
    <h2>Reis aanmaken / bewerken</h2>
    <input type="text" id="reisVan" placeholder="Van">
    <input type="time" id="reisStart">
    <input type="number" id="reisAfstand" placeholder="Afstand (km)">
    <input type="text" id="reisNaar" placeholder="Naar">
    <input type="time" id="reisEind">
    <input type="text" id="reisDuur" placeholder="Duur">
    <textarea id="reisNotitie" placeholder="Notitie (optioneel)"></textarea>
    <input type="url" id="reisLink" placeholder="https://...">
    <button onclick="addReis()">Opslaan</button>
  </div>
  <div class="section">
    <h2>Overzicht reizen</h2>
    <div id="adminReizen" class="overview"></div>
  </div>

  <!-- Deelnemers -->
  <div class="section">
    <h2>Deelnemers</h2>
    <table id="deelnemersTabel">
      <thead>
        <tr>
          <th>Naam</th>
          <th>Wel mee</th>
          <th>Niet mee</th>
          <th>Geannuleerd</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<hr class="page-sep">

<!-- DETAIL -->
<div id="detailPage">
  <h1 id="detailTitel">Dagje Rotterdam</h1>
  <p>Inschrijven tot: <span id="detailInschrijvenTot"></span><br>Annuleren tot: <span id="detailAnnulerenTot"></span></p>

  <h2>Verzamelpunt & Tijd</h2>
  <p>Locatie: <span id="detailLocatie"></span><br>Tijd: <span id="detailTijd"></span></p>

  <h2>Wat we gaan doen</h2>
  <div id="detailPlanning" class="overview"></div>

  <h2>Deelnemers</h2>
  <ul id="overzichtMee"></ul>

  <h3>Totaal te betalen</h3>
  <p>â‚¬ 0,00 p.p.</p>

  <p><strong>Let op:</strong> <span id="detailNotitie"></span></p>

  <div id="mijnStatus"></div>
</div>

<script>
// Data
let activiteiten = [
  { naam: 'Rondvaart door de haven', start: '10:00', eind: '11:30', prijs: 16, url: 'https://voorbeeld.nl/rondvaart', type:'event' },
  { naam: 'Bezoek Euromast', start: '12:00', eind: '13:00', prijs: 10, url: 'https://voorbeeld.nl/euromast', type:'event' }
];
let reizen = [
  { naam: 'Reis naar Haven', start: '09:30', eind: '10:00', afstand: 5, duur: '15 min', link: 'https://maps.google.com', type:'reis' }
];
let deelnemers = [
  { naam: 'Marcel', welMee: false, geannuleerd: false },
  { naam: 'Petra', welMee: true, geannuleerd: false },
  { naam: 'Jan', welMee: false, geannuleerd: true }
];
const ingelogdeNaam = 'Marcel';

function euroBedrag(n) { return Number(n||0).toFixed(2).replace('.', ','); }

function addEvent(){
  const naam = document.getElementById('evtNaam').value;
  if(!naam) return;
  activiteiten.push({
    naam,
    start: document.getElementById('evtStart').value,
    eind: document.getElementById('evtEind').value,
    prijs: document.getElementById('evtPrijs').value,
    url: document.getElementById('evtUrl').value,
    notitie: document.getElementById('evtNotitie').value,
    type:'event'
  });
  renderAll();
}

function addReis(){
  const van = document.getElementById('reisVan').value;
  const naar = document.getElementById('reisNaar').value;
  if(!van || !naar) return;
  reizen.push({
    naam: `${van} â†’ ${naar}`,
    start: document.getElementById('reisStart').value,
    eind: document.getElementById('reisEind').value,
    afstand: document.getElementById('reisAfstand').value,
    duur: document.getElementById('reisDuur').value,
    link: document.getElementById('reisLink').value,
    notitie: document.getElementById('reisNotitie').value,
    type:'reis'
  });
  renderAll();
}

function renderAdminList(el, list, type){
  el.innerHTML = '';
  list.forEach((item, idx) => {
    const seg = [];
    if(type==='event'){
      seg.push(`ğŸ ${item.naam}`);
      if(item.start || item.eind) seg.push(`ğŸ•’ ${item.start||''}${(item.start&&item.eind)?' - ':''}${item.eind||''}`);
      if(item.prijs) seg.push(`ğŸ’¶ â‚¬ ${euroBedrag(item.prijs)} p.p.`);
      if(item.url) seg.push('ğŸ”— Link');
    } else {
      seg.push(`ğŸš— ${item.naam}`);
      if(item.start || item.eind) seg.push(`ğŸ•’ ${item.start||''}${(item.start&&item.eind)?' - ':''}${item.eind||''}`);
      if(item.afstand) seg.push(`ğŸ“ ${String(item.afstand).replace('.', ',')} km`);
      if(item.duur) seg.push(`â±ï¸ ${item.duur}`);
      if(item.link) seg.push(`<a href="${item.link}" target="_blank">ğŸ”— Route</a>`);
    }
    const row = document.createElement('div');
    row.className = 'overview-item';
    const info = document.createElement('span');
    info.innerHTML = seg.join(' | ');
    const actions = document.createElement('span');
    const btnEdit = document.createElement('button');
    btnEdit.textContent = 'Bewerken';
    btnEdit.onclick = () => {
      if(type==='event'){
        document.getElementById('evtNaam').value = item.naam;
        document.getElementById('evtStart').value = item.start;
        document.getElementById('evtEind').value = item.eind;
        document.getElementById('evtPrijs').value = item.prijs;
        document.getElementById('evtUrl').value = item.url;
        document.getElementById('evtNotitie').value = item.notitie || '';
      } else {
        const parts = item.naam.split(' â†’ ');
        document.getElementById('reisVan').value = parts[0]||'';
        document.getElementById('reisNaar').value = parts[1]||'';
        document.getElementById('reisStart').value = item.start;
        document.getElementById('reisEind').value = item.eind;
        document.getElementById('reisAfstand').value = item.afstand;
        document.getElementById('reisDuur').value = item.duur;
        document.getElementById('reisLink').value = item.link;
        document.getElementById('reisNotitie').value = item.notitie || '';
      }
      list.splice(idx,1);
      renderAll();
    };
    const btnRemove = document.createElement('button');
    btnRemove.textContent = 'Verwijderen';
    btnRemove.onclick = () => { list.splice(idx,1); renderAll(); };
    actions.appendChild(btnEdit);
    actions.appendChild(btnRemove);
    row.appendChild(info);
    row.appendChild(actions);
    el.appendChild(row);
  });
}

function renderDeelnemersAdmin(){
  const tbody = document.querySelector('#deelnemersTabel tbody');
  tbody.innerHTML = '';
  deelnemers.forEach(d => {
    const tr = document.createElement('tr');
    const tdNaam = document.createElement('td');
    tdNaam.textContent = d.naam;
    tr.appendChild(tdNaam);

    const tdWel = document.createElement('td');
    tdWel.className = 'welmee';
    const chkWel = document.createElement('input');
    chkWel.type = 'checkbox';
    chkWel.checked = d.welMee;
    chkWel.addEventListener('change', e => {
      d.welMee = e.target.checked;
      if(d.welMee) d.geannuleerd = false;
      renderAll();
    });
    tdWel.appendChild(chkWel);
    tr.appendChild(tdWel);

    const tdNiet = document.createElement('td');
    tdNiet.className = 'nietmee';
    const chkNiet = document.createElement('input');
    chkNiet.type = 'checkbox';
    chkNiet.checked = !d.welMee && !d.geannuleerd;
    chkNiet.addEventListener('change', e => {
      if(e.target.checked){
        d.welMee = false;
        d.geannuleerd = false;
        renderAll();
      }
    });
    tdNiet.appendChild(chkNiet);
    tr.appendChild(tdNiet);

    const tdAnn = document.createElement('td');
    tdAnn.className = 'geannuleerd';
    const chkAnn = document.createElement('input');
    chkAnn.type = 'checkbox';
    chkAnn.checked = d.geannuleerd;
    chkAnn.addEventListener('change', e => {
      d.geannuleerd = e.target.checked;
      if(d.geannuleerd) d.welMee = false;
      renderAll();
    });
    tdAnn.appendChild(chkAnn);
    tr.appendChild(tdAnn);

    tbody.appendChild(tr);
  });
}

function renderOverzichtFrontend(){
  const lijst = document.getElementById('overzichtMee');
  lijst.innerHTML = '';
  deelnemers.filter(d => d.welMee && !d.geannuleerd)
    .forEach(d => {
      const li = document.createElement('li');
      li.textContent = d.naam;
      lijst.appendChild(li);
    });
}

function renderDeelnemerFrontend(){
  const container = document.getElementById('mijnStatus');
  container.innerHTML = '';
  const deelnemer = deelnemers.find(d => d.naam === ingelogdeNaam);
  if(!deelnemer) return;
  let statusDiv = document.createElement('div');
  statusDiv.classList.add('status-stempel');
  if(deelnemer.geannuleerd){
    statusDiv.textContent = 'GEANNULEERD';
    statusDiv.classList.add('status-rood');
    container.appendChild(statusDiv);
    return;
  }
  if(deelnemer.welMee){
    statusDiv.textContent = 'GAAT MEE';
    statusDiv.classList.add('status-groen');
    container.appendChild(statusDiv);
    const btnAnnuleer = document.createElement('button');
    btnAnnuleer.textContent = 'Annuleer deelname';
    btnAnnuleer.onclick = () => { deelnemer.geannuleerd = true; deelnemer.welMee = false; renderAll(); };
    container.appendChild(document.createElement('br'));
    container.appendChild(btnAnnuleer);
  } else {
    statusDiv.textContent = 'GAAT NIET MEE';
    statusDiv.classList.add('status-rood');
    container.appendChild(statusDiv);
        const btnMee = document.createElement('button');
    btnMee.textContent = 'Ik ga mee';
    btnMee.onclick = () => { 
      deelnemer.welMee = true; 
      deelnemer.geannuleerd = false; 
      renderAll(); 
    };
    container.appendChild(document.createElement('br'));
    container.appendChild(btnMee);
  }
}

function renderDetailPlanning(){
  const el = document.getElementById('detailPlanning');
  el.innerHTML = '';
  const combined = [...activiteiten, ...reizen];
  combined.sort((a,b) => (a.start||'').localeCompare(b.start||''));
  combined.forEach(item => {
    const seg = [];
    if(item.type==='event'){
      seg.push(`ğŸ ${item.naam}`);
      if(item.start || item.eind) seg.push(`ğŸ•’ ${item.start||''}${(item.start&&item.eind)?' - ':''}${item.eind||''}`);
      if(item.prijs) seg.push(`ğŸ’¶ â‚¬ ${euroBedrag(item.prijs)} p.p.`);
      if(item.url) seg.push('ğŸ”— Link');
    } else {
      seg.push(`ğŸš— ${item.naam}`);
      if(item.start || item.eind) seg.push(`ğŸ•’ ${item.start||''}${(item.start&&item.eind)?' - ':''}${item.eind||''}`);
      if(item.afstand) seg.push(`ğŸ“ ${String(item.afstand).replace('.', ',')} km`);
      if(item.duur) seg.push(`â±ï¸ ${item.duur}`);
      if(item.link) seg.push(`<a href="${item.link}" target="_blank">ğŸ”— Route</a>`);
    }
    const row = document.createElement('div');
    row.className = 'overview-item';
    row.innerHTML = seg.join(' | ');
    el.appendChild(row);
  });
}

const adminPage = document.getElementById('adminPage');
const detailPage = document.getElementById('detailPage');
const pageSep = document.querySelector('.page-sep');

function showAdminPage() {
  adminPage.style.display = 'block';
  detailPage.style.display = 'none';
  if (pageSep) pageSep.style.display = 'none';
}
function showDetailPage() {
  adminPage.style.display = 'none';
  detailPage.style.display = 'block';
  if (pageSep) pageSep.style.display = 'none';
}
function showBothPages() {
  adminPage.style.display = 'block';
  detailPage.style.display = 'block';
  if (pageSep) pageSep.style.display = 'block';
}

document.getElementById('showAdmin').addEventListener('click', showAdminPage);
document.getElementById('showDetail').addEventListener('click', showDetailPage);
document.getElementById('showBoth').addEventListener('click', showBothPages);

function renderAll(){
  // Adminâ€‘overzichten
  renderAdminList(document.getElementById('adminActiviteiten'), activiteiten, 'event');
  renderAdminList(document.getElementById('adminReizen'), reizen, 'reis');
  renderDeelnemersAdmin();
  // Detailpagina
  document.getElementById('detailTitel').textContent = document.getElementById('admTitel').value;
  document.getElementById('detailInschrijvenTot').textContent = document.getElementById('admInschrijvenTot').value;
  document.getElementById('detailAnnulerenTot').textContent = document.getElementById('admAnnulerenTot').value;
  document.getElementById('detailLocatie').textContent = document.getElementById('admVerzamelLocatie').value;
  document.getElementById('detailTijd').textContent = document.getElementById('admVerzamelTijd').value;
  document.getElementById('detailNotitie').textContent = document.getElementById('admNotitie').value;
  renderOverzichtFrontend();
  renderDeelnemerFrontend();
  renderDetailPlanning();
}

document.addEventListener('DOMContentLoaded', () => {
  renderAll();
  showAdminPage();
});
</script>
</body>
</html>
